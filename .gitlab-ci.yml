image: williamyeh/ansible:debian9

before_script:
    - 'which ssh-agent || ( apt update -y && apt install openssh-client -y)'
    - eval $(ssh-agent -s)
    - ssh-add <(echo "$PRIVATE")
    - mkdir -p ~/.ssh
    - '[[ -f /.dockerenv ]] && echo -e "Host *\n\tStrictHostKeyChecking no\n\n" > ~/.ssh/config'
    
build:
  script:
    - ls
    - cat hosts
    - ansible --version
    #- pip install boto boto3 netaddr passlib
    - ansible -m ping all -i hosts
    - sudo ansible-playbook docker_install.yml
