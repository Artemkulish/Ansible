stages:
    - ansible

.ansible_template: &ansible_template
    stage: ansible
    script:
        - ansible-playbook $PLAYBOOK
    when: manual
    
database_instance:
    <<: *ansible_template
    variables:
        PLAYBOOK: p2.yml
    only:
        changes:
            - p2.yml  

webserver_instance:
    <<: *ansible_template
    variables:
        PLAYBOOK: work_script.yml
    only:
        changes:
            - work_script.yml
            
docker_installation:
    <<: *ansible_template
    variables:
        PLAYBOOK: docker_install.yml
    only:
        changes:
            - docker_install.yml
            
conteiner-opimized:
    <<: *ansible_template
    variables:
        PLAYBOOK: create_conteiner-opt.yml
    only:
        changes:
            - create_conteiner-opt.yml

network:
    <<: *ansible_template
    variables:
        PLAYBOOK: network.yml
    only:
        changes:
            - network.yml
            
cloud-sql:
    <<: *ansible_template
    variables:
        PLAYBOOK: cloudsql.yml
    only:
        changes:
            - cloudsql.yml          

load-balancer:
    <<: *ansible_template
    variables:
        PLAYBOOK: loadbalancer.yml
    only:
        changes:
            - loadbalancer.yml  
